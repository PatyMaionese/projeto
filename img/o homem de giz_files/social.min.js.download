var windowProxy=null;var windowProxyPushPixel=null;var soclInitializer={};(function(context){var getUserProfile=function(callback){soclConnect.fbEnsureInit(function(){soclConnect.getStatus(function(connected){if(connected){FB.api("me?fields=id,first_name,picture.width(100).height(100)",function(response){if(response&&!response.error){callback(response)}else{callback(null)}})}else{callback(null)}})})};var setTemplate=function(fbProfile,pluginParameters,metadata){$("<style type='text/css'> #OnSite body .brand { background-color:"+pluginParameters.logoColor+"; } #OnSite body .brand__ty i, #OnSite body .btn, #OnSite body > div.plg, #OnSite body.pop .pop-box { background-color: "+pluginParameters.background+"; } </style>").appendTo("body");$(".brand__img").attr("src",metadata.path+"/logo.png?v="+(new Date).getTime());if(fbProfile!==null){$(".not div h1").text(soclHelper.replaceAll("{0}",fbProfile.first_name,pluginParameters.title));$(".not div p").text(soclHelper.replaceAll("{0}",fbProfile.first_name,pluginParameters.message))}else{$(".not div h1").text(soclHelper.replaceAll("{0}","",pluginParameters.title));$(".not div p").text(soclHelper.replaceAll("{0}","",pluginParameters.message))}$(".plg").addClass(pluginParameters.orientation+" "+pluginParameters.textOption)};var setTriggers=function(pluginParameters,metadata){var timeout=3e3;setTimeout(function(){if(pluginParameters.animation){windowProxy.post({show:pluginParameters.orientation+"|"+metadata.pluginId+"|"+pluginParameters.pagesViewBefore+"|"+pluginParameters.timeToShowAfterView})}setTimeout(function(){$("body > div.plg .brand__ty").removeClass("hide");$("body > div.plg .brand__al").addClass("hide");setTimeout(function(){$(".plg").addClass("open");$("div.open").click(function(){windowProxy.post({click:metadata.pluginId+"|"+metadata.customerId+"|"+pluginParameters.showAfterClick+"|"+pluginParameters.link})});windowProxy.post({open:pluginParameters.timeToShowAfterView+"|"+pluginParameters.orientation+"|"+metadata.customerId+"|"+metadata.pluginId+"|"+pluginParameters.pagesViewBefore})},timeout)},timeout)},pluginParameters.scrollPercentage>0?0:pluginParameters.timeInSite)};var setGlobalSettings=function(pluginParameters,customerId,pluginId){if(appConfig.IsApple()){$(".close").on("click touchend",function(evt){evt.stopImmediatePropagation();windowProxy.post({close:pluginParameters.timeToShowAfterClose+"|"+pluginId})})}else{$(".close").click(function(evt){evt.stopImmediatePropagation();windowProxy.post({close:pluginParameters.timeToShowAfterClose+"|"+pluginId})})}$(".brand").click(function(){$(".plg").addClass("open");windowProxy.post({clickToOpen:pluginId});windowProxy.post({open:pluginParameters.timeToShowAfterView+"|"+pluginParameters.orientation+"|"+customerId+"|"+pluginId})});$(".by").click(function(evt){evt.stopImmediatePropagation()})};context.start=function(metadata){var pluginParameters=JSON.parse(decodeURIComponent(metadata.pluginParameters));metadata.path=metadata.path.replace("{PID}",metadata.pluginId);setGlobalSettings(pluginParameters,metadata.customerId,metadata.pluginId);if(metadata.appId!="undefined"&&metadata.appId!=null){getUserProfile(function(fbProfile){setTemplate(fbProfile,pluginParameters,metadata);setTriggers(pluginParameters,metadata)})}else{setTemplate(null,pluginParameters,metadata);setTriggers(pluginParameters,metadata)}}})(soclInitializer);